<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Substrate runtime api"><meta name="keywords" content="rust, rustlang, rust-lang, sp_api"><title>sp_api - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../sp_api/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../sp_api/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate sp_api</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 4.0.0-dev</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Crate <a class="mod" href="#">sp_api</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/sp_api/lib.rs.html#18-678">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Substrate runtime api</p>
<p>The Substrate runtime api is the interface between the node and the runtime. There isn’t a fixed
set of runtime apis, instead it is up to the user to declare and implement these runtime apis.
The declaration of a runtime api is normally done outside of a runtime, while the implementation
of it has to be done in the runtime. We provide the <a href="macro.decl_runtime_apis.html" title="decl_runtime_apis!"><code>decl_runtime_apis!</code></a> macro for declaring
a runtime api and the <a href="macro.impl_runtime_apis.html" title="impl_runtime_apis!"><code>impl_runtime_apis!</code></a> for implementing them. The macro docs provide more
information on how to use them and what kind of attributes we support.</p>
<p>It is required that each runtime implements at least the <a href="trait.Core.html" title="Core"><code>Core</code></a> runtime api. This runtime api
provides all the core functions that Substrate expects from a runtime.</p>
<h2 id="versioning"><a href="#versioning">Versioning</a></h2>
<p>Runtime apis support versioning. Each runtime api itself has a version attached. It is also
supported to change function signatures or names in a non-breaking way. For more information on
versioning check the <a href="macro.decl_runtime_apis.html" title="decl_runtime_apis!"><code>decl_runtime_apis!</code></a> macro.</p>
<p>All runtime apis and their versions are returned as part of the <a href="../sp_version/struct.RuntimeVersion.html" title="RuntimeVersion"><code>RuntimeVersion</code></a>. This can be
used to check which runtime api version is currently provided by the on-chain runtime.</p>
<h2 id="testing"><a href="#testing">Testing</a></h2>
<p>For testing we provide the <a href="macro.mock_impl_runtime_apis.html" title="mock_impl_runtime_apis!"><code>mock_impl_runtime_apis!</code></a> macro that lets you implement a runtime
api for a mocked object to use it in tests.</p>
<h2 id="logging"><a href="#logging">Logging</a></h2>
<p>Substrate supports logging from the runtime in native and in wasm. For that purpose it provides
the <a href="../sp_runtime/runtime_logger/struct.RuntimeLogger.html"><code>RuntimeLogger</code></a>. This runtime logger is
automatically enabled for each call into the runtime through the runtime api. As logging
introduces extra code that isn’t actually required for the logic of your runtime and also
increases the final wasm blob size, it is recommended to disable the logging for on-chain
wasm blobs. This can be done by enabling the <code>disable-logging</code> feature of this crate. Be aware
that this feature instructs <code>log</code> and <code>tracing</code> to disable logging at compile time by setting
the <code>max_level_off</code> feature for these crates. So, you should not enable this feature for a
native build as otherwise the node will not output any log messages.</p>
<h2 id="how-does-it-work"><a href="#how-does-it-work">How does it work?</a></h2>
<p>Each runtime api is declared as a trait with functions. When compiled to WASM, each implemented
runtime api function is exported as a function with the following naming scheme
<code>${TRAIT_NAME}_${FUNCTION_NAME}</code>. Such a function has the following signature
<code>(ptr: *u8, length: u32) -&gt; u64</code>. It takes a pointer to an <code>u8</code> array and its length as an
argument. This <code>u8</code> array is expected to be the SCALE encoded parameters of the function as
defined in the trait. The return value is an <code>u64</code> that represents <code>length &lt;&lt; 32 | pointer</code> of
an <code>u8</code> array. This return value <code>u8</code> array contains the SCALE encoded return value as defined
by the trait function. The macros take care to encode the parameters and to decode the return
value.</p>
</div></details><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.decl_runtime_apis.html" title="sp_api::decl_runtime_apis macro">decl_runtime_apis</a></div><div class="item-right docblock-short">Declares given traits as runtime apis.</div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.impl_runtime_apis.html" title="sp_api::impl_runtime_apis macro">impl_runtime_apis</a></div><div class="item-right docblock-short">Tags given trait implementations as runtime apis.</div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.mock_impl_runtime_apis.html" title="sp_api::mock_impl_runtime_apis macro">mock_impl_runtime_apis</a></div><div class="item-right docblock-short">Mocks given trait implementations as runtime apis.</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ApiRef.html" title="sp_api::ApiRef struct">ApiRef</a></div><div class="item-right docblock-short">Auxiliary wrapper that holds an api instance and binds it to the given lifetime.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CallApiAtParams.html" title="sp_api::CallApiAtParams struct">CallApiAtParams</a></div><div class="item-right docblock-short">Parameters for <a href="trait.CallApiAt.html#tymethod.call_api_at" title="CallApiAt::call_api_at"><code>CallApiAt::call_api_at</code></a>.</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.ApiError.html" title="sp_api::ApiError enum">ApiError</a></div><div class="item-right docblock-short">An error describing which API call failed.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.StateVersion.html" title="sp_api::StateVersion enum">StateVersion</a></div><div class="item-right docblock-short">Different possible state version.</div></div></div><h2 id="constants" class="small-section-header"><a href="#constants">Constants</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.MAX_EXTRINSIC_DEPTH.html" title="sp_api::MAX_EXTRINSIC_DEPTH constant">MAX_EXTRINSIC_DEPTH</a></div><div class="item-right docblock-short">Maximum nesting level for extrinsics.</div></div><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.RUNTIME_API_INFO_SIZE.html" title="sp_api::RUNTIME_API_INFO_SIZE constant">RUNTIME_API_INFO_SIZE</a></div><div class="item-right docblock-short">The number of bytes required to encode a <a href="trait.RuntimeApiInfo.html" title="RuntimeApiInfo"><code>RuntimeApiInfo</code></a>.</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.ApiExt.html" title="sp_api::ApiExt trait">ApiExt</a></div><div class="item-right docblock-short">Extends the runtime api implementation with some common functionality.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.CallApiAt.html" title="sp_api::CallApiAt trait">CallApiAt</a></div><div class="item-right docblock-short">Something that can call into the an api at a given block.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.ConstructRuntimeApi.html" title="sp_api::ConstructRuntimeApi trait">ConstructRuntimeApi</a></div><div class="item-right docblock-short">Something that can be constructed to a runtime api.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Core.html" title="sp_api::Core trait">Core</a></div><div class="item-right docblock-short">The <code>Core</code> runtime api that every Substrate runtime needs to implement.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Metadata.html" title="sp_api::Metadata trait">Metadata</a></div><div class="item-right docblock-short">The <code>Metadata</code> api trait that returns metadata for the runtime.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.ProvideRuntimeApi.html" title="sp_api::ProvideRuntimeApi trait">ProvideRuntimeApi</a></div><div class="item-right docblock-short">Something that provides a runtime api.</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.RuntimeApiInfo.html" title="sp_api::RuntimeApiInfo trait">RuntimeApiInfo</a></div><div class="item-right docblock-short">Something that provides information about a runtime api.</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.deserialize_runtime_api_info.html" title="sp_api::deserialize_runtime_api_info fn">deserialize_runtime_api_info</a></div><div class="item-right docblock-short">Deserialize the runtime API info serialized by <a href="fn.serialize_runtime_api_info.html" title="serialize_runtime_api_info"><code>serialize_runtime_api_info</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.init_runtime_logger.html" title="sp_api::init_runtime_logger fn">init_runtime_logger</a></div><div class="item-right docblock-short">Init the <a href="../sp_runtime/runtime_logger/struct.RuntimeLogger.html"><code>RuntimeLogger</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.serialize_runtime_api_info.html" title="sp_api::serialize_runtime_api_info fn">serialize_runtime_api_info</a></div><div class="item-right docblock-short">Crude and simple way to serialize the <code>RuntimeApiInfo</code> into a bunch of bytes.</div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.ProofRecorder.html" title="sp_api::ProofRecorder type">ProofRecorder</a></div><div class="item-right docblock-short">A type that records all accessed trie nodes and generates a proof out of it.</div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.StateBackendFor.html" title="sp_api::StateBackendFor type">StateBackendFor</a></div><div class="item-right docblock-short">Extract the state backend type for a type that implements <code>ProvideRuntimeApi</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.StorageChanges.html" title="sp_api::StorageChanges type">StorageChanges</a></div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.StorageTransactionCache.html" title="sp_api::StorageTransactionCache type">StorageTransactionCache</a></div><div class="item-right docblock-short">A type that is used as cache for the storage transactions.</div></div><div class="item-row"><div class="item-left module-item"><a class="type" href="type.TransactionFor.html" title="sp_api::TransactionFor type">TransactionFor</a></div><div class="item-right docblock-short">Extract the state backend transaction type for a type that implements <code>ProvideRuntimeApi</code>.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="sp_api" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.1 (90743e729 2023-01-10)" ></div></body></html>