<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="An implementation of a compiler which can compile WebAssembly functions to machine code and perform other miscellaneous tasks needed by the JIT runtime."><meta name="keywords" content="rust, rustlang, rust-lang, Compiler"><title>Compiler in wasmtime_environ - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-6827029ac823cab7.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../static.files/light-ebce58d0a40c3431.css"><link rel="stylesheet" disabled href="../static.files/dark-f23faae4a2daf9a6.css"><link rel="stylesheet" disabled href="../static.files/ayu-8af5e100b21cd173.css"><script id="default-settings" ></script><script src="../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-c55e1eb52e1886b4.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../wasmtime_environ/index.html"><div class="logo-container"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../wasmtime_environ/index.html"><div class="logo-container"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2 class="location"><a href="#">Compiler</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.append_code">append_code</a></li><li><a href="#tymethod.append_dwarf">append_dwarf</a></li><li><a href="#tymethod.compile_function">compile_function</a></li><li><a href="#tymethod.compile_host_to_wasm_trampoline">compile_host_to_wasm_trampoline</a></li><li><a href="#tymethod.emit_trampoline_obj">emit_trampoline_obj</a></li><li><a href="#tymethod.flags">flags</a></li><li><a href="#tymethod.is_branch_protection_enabled">is_branch_protection_enabled</a></li><li><a href="#tymethod.isa_flags">isa_flags</a></li><li><a href="#tymethod.page_size_align">page_size_align</a></li><li><a href="#tymethod.triple">triple</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.object">object</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In wasmtime_environ</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Trait <a href="index.html">wasmtime_environ</a>::<wbr><a class="trait" href="#">Compiler</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/wasmtime_environ/compilation.rs.html#158-296">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><div class="item-decl"><pre class="rust trait"><code>pub trait Compiler: <a class="trait" href="__core/marker/trait.Send.html" title="trait wasmtime_environ::__core::marker::Send">Send</a> + <a class="trait" href="__core/marker/trait.Sync.html" title="trait wasmtime_environ::__core::marker::Sync">Sync</a> {
    fn <a href="#tymethod.compile_function" class="fn">compile_function</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;translation: &amp;<a class="struct" href="struct.ModuleTranslation.html" title="struct wasmtime_environ::ModuleTranslation">ModuleTranslation</a>&lt;'_&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index: <a class="struct" href="struct.DefinedFuncIndex.html" title="struct wasmtime_environ::DefinedFuncIndex">DefinedFuncIndex</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data: <a class="struct" href="struct.FunctionBodyData.html" title="struct wasmtime_environ::FunctionBodyData">FunctionBodyData</a>&lt;'_&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tunables: &amp;<a class="struct" href="struct.Tunables.html" title="struct wasmtime_environ::Tunables">Tunables</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;types: &amp;<a class="struct" href="struct.ModuleTypes.html" title="struct wasmtime_environ::ModuleTypes">ModuleTypes</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;(<a class="struct" href="struct.WasmFunctionInfo.html" title="struct wasmtime_environ::WasmFunctionInfo">WasmFunctionInfo</a>, <a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="__core/any/trait.Any.html" title="trait wasmtime_environ::__core::any::Any">Any</a> + <a class="trait" href="__core/marker/trait.Send.html" title="trait wasmtime_environ::__core::marker::Send">Send</a>&gt;), <a class="enum" href="enum.CompileError.html" title="enum wasmtime_environ::CompileError">CompileError</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.compile_host_to_wasm_trampoline" class="fn">compile_host_to_wasm_trampoline</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ty: &amp;<a class="struct" href="struct.WasmFuncType.html" title="struct wasmtime_environ::WasmFuncType">WasmFuncType</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="__core/any/trait.Any.html" title="trait wasmtime_environ::__core::any::Any">Any</a> + <a class="trait" href="__core/marker/trait.Send.html" title="trait wasmtime_environ::__core::marker::Send">Send</a>&gt;, <a class="enum" href="enum.CompileError.html" title="enum wasmtime_environ::CompileError">CompileError</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.append_code" class="fn">append_code</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj: &amp;mut Object&lt;'static&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcs: &amp;[(<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="__core/any/trait.Any.html" title="trait wasmtime_environ::__core::any::Any">Any</a> + <a class="trait" href="__core/marker/trait.Send.html" title="trait wasmtime_environ::__core::marker::Send">Send</a>&gt;)],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tunables: &amp;<a class="struct" href="struct.Tunables.html" title="struct wasmtime_environ::Tunables">Tunables</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resolve_reloc: &amp;dyn <a class="trait" href="__core/ops/trait.Fn.html" title="trait wasmtime_environ::__core::ops::Fn">Fn</a>(<a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.usize.html">usize</a>, <a class="struct" href="struct.FuncIndex.html" title="struct wasmtime_environ::FuncIndex">FuncIndex</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.usize.html">usize</a><br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;(SymbolId, <a class="struct" href="struct.FunctionLoc.html" title="struct wasmtime_environ::FunctionLoc">FunctionLoc</a>)&gt;&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.emit_trampoline_obj" class="fn">emit_trampoline_obj</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ty: &amp;<a class="struct" href="struct.WasmFuncType.html" title="struct wasmtime_environ::WasmFuncType">WasmFuncType</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_fn: <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.usize.html">usize</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj: &amp;mut Object&lt;'static&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;(<a class="struct" href="struct.FunctionLoc.html" title="struct wasmtime_environ::FunctionLoc">FunctionLoc</a>, <a class="struct" href="struct.FunctionLoc.html" title="struct wasmtime_environ::FunctionLoc">FunctionLoc</a>)&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.triple" class="fn">triple</a>(&amp;self) -&gt; &amp;<a class="struct" href="../target_lexicon/triple/struct.Triple.html" title="struct target_lexicon::triple::Triple">Triple</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.page_size_align" class="fn">page_size_align</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.u64.html">u64</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.flags" class="fn">flags</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/collections/btree/map/struct.BTreeMap.html" title="struct alloc::collections::btree::map::BTreeMap">BTreeMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="enum" href="enum.FlagValue.html" title="enum wasmtime_environ::FlagValue">FlagValue</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.isa_flags" class="fn">isa_flags</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/collections/btree/map/struct.BTreeMap.html" title="struct alloc::collections::btree::map::BTreeMap">BTreeMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="enum" href="enum.FlagValue.html" title="enum wasmtime_environ::FlagValue">FlagValue</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.is_branch_protection_enabled" class="fn">is_branch_protection_enabled</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.append_dwarf" class="fn">append_dwarf</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj: &amp;mut Object&lt;'_&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;translation: &amp;<a class="struct" href="struct.ModuleTranslation.html" title="struct wasmtime_environ::ModuleTranslation">ModuleTranslation</a>&lt;'_&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funcs: &amp;<a class="struct" href="struct.PrimaryMap.html" title="struct wasmtime_environ::PrimaryMap">PrimaryMap</a>&lt;<a class="struct" href="struct.DefinedFuncIndex.html" title="struct wasmtime_environ::DefinedFuncIndex">DefinedFuncIndex</a>, (SymbolId, &amp;(dyn <a class="trait" href="__core/any/trait.Any.html" title="trait wasmtime_environ::__core::any::Any">Any</a> + <a class="trait" href="__core/marker/trait.Send.html" title="trait wasmtime_environ::__core::marker::Send">Send</a>))&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.unit.html">()</a>&gt;;

    fn <a href="#method.object" class="fn">object</a>(&amp;self, kind: <a class="enum" href="enum.ObjectKind.html" title="enum wasmtime_environ::ObjectKind">ObjectKind</a>) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;Object&lt;'static&gt;&gt; { ... }
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>An implementation of a compiler which can compile WebAssembly functions to
machine code and perform other miscellaneous tasks needed by the JIT runtime.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.compile_function" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#164-171">source</a><h4 class="code-header">fn <a href="#tymethod.compile_function" class="fn">compile_function</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;translation: &amp;<a class="struct" href="struct.ModuleTranslation.html" title="struct wasmtime_environ::ModuleTranslation">ModuleTranslation</a>&lt;'_&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;index: <a class="struct" href="struct.DefinedFuncIndex.html" title="struct wasmtime_environ::DefinedFuncIndex">DefinedFuncIndex</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;data: <a class="struct" href="struct.FunctionBodyData.html" title="struct wasmtime_environ::FunctionBodyData">FunctionBodyData</a>&lt;'_&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;tunables: &amp;<a class="struct" href="struct.Tunables.html" title="struct wasmtime_environ::Tunables">Tunables</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;types: &amp;<a class="struct" href="struct.ModuleTypes.html" title="struct wasmtime_environ::ModuleTypes">ModuleTypes</a><br>) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;(<a class="struct" href="struct.WasmFunctionInfo.html" title="struct wasmtime_environ::WasmFunctionInfo">WasmFunctionInfo</a>, <a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="__core/any/trait.Any.html" title="trait wasmtime_environ::__core::any::Any">Any</a> + <a class="trait" href="__core/marker/trait.Send.html" title="trait wasmtime_environ::__core::marker::Send">Send</a>&gt;), <a class="enum" href="enum.CompileError.html" title="enum wasmtime_environ::CompileError">CompileError</a>&gt;</h4></section></summary><div class="docblock"><p>Compiles the function <code>index</code> within <code>translation</code>.</p>
<p>The body of the function is available in <code>data</code> and configuration
values are also passed in via <code>tunables</code>. Type information in
<code>translation</code> is all relative to <code>types</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.compile_host_to_wasm_trampoline" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#175-178">source</a><h4 class="code-header">fn <a href="#tymethod.compile_host_to_wasm_trampoline" class="fn">compile_host_to_wasm_trampoline</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;ty: &amp;<a class="struct" href="struct.WasmFuncType.html" title="struct wasmtime_environ::WasmFuncType">WasmFuncType</a><br>) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="__core/any/trait.Any.html" title="trait wasmtime_environ::__core::any::Any">Any</a> + <a class="trait" href="__core/marker/trait.Send.html" title="trait wasmtime_environ::__core::marker::Send">Send</a>&gt;, <a class="enum" href="enum.CompileError.html" title="enum wasmtime_environ::CompileError">CompileError</a>&gt;</h4></section></summary><div class="docblock"><p>Creates a function of type <code>VMTrampoline</code> which will then call the
function pointer argument which has the <code>ty</code> type provided.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.append_code" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#202-208">source</a><h4 class="code-header">fn <a href="#tymethod.append_code" class="fn">append_code</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;obj: &amp;mut Object&lt;'static&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;funcs: &amp;[(<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="__core/any/trait.Any.html" title="trait wasmtime_environ::__core::any::Any">Any</a> + <a class="trait" href="__core/marker/trait.Send.html" title="trait wasmtime_environ::__core::marker::Send">Send</a>&gt;)],<br>&nbsp;&nbsp;&nbsp;&nbsp;tunables: &amp;<a class="struct" href="struct.Tunables.html" title="struct wasmtime_environ::Tunables">Tunables</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;resolve_reloc: &amp;dyn <a class="trait" href="__core/ops/trait.Fn.html" title="trait wasmtime_environ::__core::ops::Fn">Fn</a>(<a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.usize.html">usize</a>, <a class="struct" href="struct.FuncIndex.html" title="struct wasmtime_environ::FuncIndex">FuncIndex</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.usize.html">usize</a><br>) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;(SymbolId, <a class="struct" href="struct.FunctionLoc.html" title="struct wasmtime_environ::FunctionLoc">FunctionLoc</a>)&gt;&gt;</h4></section></summary><div class="docblock"><p>Appends a list of compiled functions to an in-memory object.</p>
<p>This function will receive the same <code>Box&lt;dyn Ayn&gt;</code> produced as part of
compilation from functions like <code>compile_function</code>,
compile_host_to_wasm_trampoline`, and other component-related shims.
Internally this will take all of these functions and add information to
the object such as:</p>
<ul>
<li>Compiled code in a <code>.text</code> section</li>
<li>Unwind information in Wasmtime-specific sections</li>
<li>Relocations, if necessary, for the text section</li>
</ul>
<p>Each function is accompanied with its desired symbol name and the return
value of this function is the symbol for each function as well as where
each function was placed within the object.</p>
<p>The <code>resolve_reloc</code> argument is intended to resolving relocations
between function, chiefly resolving intra-module calls within one core
wasm module. The closure here takes two arguments: first the index
within <code>funcs</code> that is being resolved and next the <code>FuncIndex</code> which is
the relocation target to resolve. The return value is an index within
<code>funcs</code> that the relocation points to.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.emit_trampoline_obj" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#217-222">source</a><h4 class="code-header">fn <a href="#tymethod.emit_trampoline_obj" class="fn">emit_trampoline_obj</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;ty: &amp;<a class="struct" href="struct.WasmFuncType.html" title="struct wasmtime_environ::WasmFuncType">WasmFuncType</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;host_fn: <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.usize.html">usize</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;obj: &amp;mut Object&lt;'static&gt;<br>) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;(<a class="struct" href="struct.FunctionLoc.html" title="struct wasmtime_environ::FunctionLoc">FunctionLoc</a>, <a class="struct" href="struct.FunctionLoc.html" title="struct wasmtime_environ::FunctionLoc">FunctionLoc</a>)&gt;</h4></section></summary><div class="docblock"><p>Inserts two functions for host-to-wasm and wasm-to-host trampolines into
the <code>obj</code> provided.</p>
<p>This will configure the same sections as <code>emit_obj</code>, but will likely be
much smaller. The two returned <code>Trampoline</code> structures describe where to
find the host-to-wasm and wasm-to-host trampolines in the text section,
respectively.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.triple" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#264">source</a><h4 class="code-header">fn <a href="#tymethod.triple" class="fn">triple</a>(&amp;self) -&gt; &amp;<a class="struct" href="../target_lexicon/triple/struct.Triple.html" title="struct target_lexicon::triple::Triple">Triple</a></h4></section></summary><div class="docblock"><p>Returns the target triple that this compiler is compiling for.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.page_size_align" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#270">source</a><h4 class="code-header">fn <a href="#tymethod.page_size_align" class="fn">page_size_align</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.u64.html">u64</a></h4></section></summary><div class="docblock"><p>Returns the alignment necessary to align values to the page size of the
compilation target. Note that this may be an upper-bound where the
alignment is larger than necessary for some platforms since it may
depend on the platform’s runtime configuration.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.flags" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#273">source</a><h4 class="code-header">fn <a href="#tymethod.flags" class="fn">flags</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/collections/btree/map/struct.BTreeMap.html" title="struct alloc::collections::btree::map::BTreeMap">BTreeMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="enum" href="enum.FlagValue.html" title="enum wasmtime_environ::FlagValue">FlagValue</a>&gt;</h4></section></summary><div class="docblock"><p>Returns a list of configured settings for this compiler.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.isa_flags" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#276">source</a><h4 class="code-header">fn <a href="#tymethod.isa_flags" class="fn">isa_flags</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/collections/btree/map/struct.BTreeMap.html" title="struct alloc::collections::btree::map::BTreeMap">BTreeMap</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.67.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <a class="enum" href="enum.FlagValue.html" title="enum wasmtime_environ::FlagValue">FlagValue</a>&gt;</h4></section></summary><div class="docblock"><p>Same as <a href="trait.Compiler.html#tymethod.flags" title="Compiler::flags"><code>Compiler::flags</code></a>, but ISA-specific (a cranelift-ism)</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.is_branch_protection_enabled" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#279">source</a><h4 class="code-header">fn <a href="#tymethod.is_branch_protection_enabled" class="fn">is_branch_protection_enabled</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Get a flag indicating whether branch protection is enabled.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.append_dwarf" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#290-295">source</a><h4 class="code-header">fn <a href="#tymethod.append_dwarf" class="fn">append_dwarf</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;obj: &amp;mut Object&lt;'_&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;translation: &amp;<a class="struct" href="struct.ModuleTranslation.html" title="struct wasmtime_environ::ModuleTranslation">ModuleTranslation</a>&lt;'_&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;funcs: &amp;<a class="struct" href="struct.PrimaryMap.html" title="struct wasmtime_environ::PrimaryMap">PrimaryMap</a>&lt;<a class="struct" href="struct.DefinedFuncIndex.html" title="struct wasmtime_environ::DefinedFuncIndex">DefinedFuncIndex</a>, (SymbolId, &amp;(dyn <a class="trait" href="__core/any/trait.Any.html" title="trait wasmtime_environ::__core::any::Any">Any</a> + <a class="trait" href="__core/marker/trait.Send.html" title="trait wasmtime_environ::__core::marker::Send">Send</a>))&gt;<br>) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Appends generated DWARF sections to the <code>obj</code> specified for the compiled
functions.</p>
</div></details></div><h2 id="provided-methods" class="small-section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.object" class="method has-srclink"><a class="srclink rightside" href="../src/wasmtime_environ/compilation.rs.html#230-261">source</a><h4 class="code-header">fn <a href="#method.object" class="fn">object</a>(&amp;self, kind: <a class="enum" href="enum.ObjectKind.html" title="enum wasmtime_environ::ObjectKind">ObjectKind</a>) -&gt; <a class="type" href="../anyhow/type.Result.html" title="type anyhow::Result">Result</a>&lt;Object&lt;'static&gt;&gt;</h4></section></summary><div class="docblock"><p>Creates a new <code>Object</code> file which is used to build the results of a
compilation into.</p>
<p>The returned object file will have an appropriate
architecture/endianness for <code>self.triple()</code>, but at this time it is
always an ELF file, regardless of target platform.</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"></div><script src="../implementors/wasmtime_environ/compilation/trait.Compiler.js" async></script></section></div></main><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="wasmtime_environ" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.1 (d5a82bbd2 2023-02-07)" data-search-js="search-444266647c4dba98.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>