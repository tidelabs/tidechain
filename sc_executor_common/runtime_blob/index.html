<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module allows for inspection and instrumentation, i.e. modifying the module to alter it’s structure or behavior, of a wasm module."><meta name="keywords" content="rust, rustlang, rust-lang, runtime_blob"><title>sc_executor_common::runtime_blob - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../../normalize.css"><link rel="stylesheet" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../../ayu.css" disabled><link rel="stylesheet" href="../../dark.css" disabled><link rel="stylesheet" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script defer src="../../main.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../sc_executor_common/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../sc_executor_common/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module runtime_blob</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Module <a href="../index.html">sc_executor_common</a>::<wbr><a class="mod" href="#">runtime_blob</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/sc_executor_common/runtime_blob/mod.rs.html#19-58">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module allows for inspection and instrumentation, i.e. modifying the module to alter it’s
structure or behavior, of a wasm module.</p>
<h3 id="instrumentation"><a href="#instrumentation">Instrumentation</a></h3>
<p>In ideal world, there would be no instrumentation. However, in the real world the execution
engines we use are somewhat limited in their APIs or abilities.</p>
<p>To give you some examples:</p>
<ul>
<li>
<p>wasmi allows reaching to non-exported mutable globals so that we could reset them. Wasmtime
doesn’t support that.</p>
<p>We need to reset the globals because when we
execute the Substrate Runtime, we do not drop and create the instance anew, instead
we restore some selected parts of the state.</p>
</li>
<li>
<p>stack depth metering can be performed via instrumentation or deferred to the engine and say be
added directly in machine code. Implementing this in machine code is rather cumbersome so
instrumentation looks like a good solution.</p>
<p>Stack depth metering is needed to make a wasm blob
execution deterministic, which in turn is needed by the Parachain Validation Function in
Polkadot.</p>
</li>
</ul>
<h3 id="inspection"><a href="#inspection">Inspection</a></h3>
<p>Inspection of a wasm module may be needed to extract some useful information, such as to extract
data segment snapshot, which is helpful for quickly restoring the initial state of instances.
Inspection can be also useful to prove that a wasm module possesses some properties, such as,
is free of any floating point operations, which is a useful step towards making instances
produced from such a module deterministic.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.DataSegmentsSnapshot.html" title="sc_executor_common::runtime_blob::DataSegmentsSnapshot struct">DataSegmentsSnapshot</a></div><div class="item-right docblock-short">This is a snapshot of data segments specialzied for a particular instantiation.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ExposedMutableGlobalsSet.html" title="sc_executor_common::runtime_blob::ExposedMutableGlobalsSet struct">ExposedMutableGlobalsSet</a></div><div class="item-right docblock-short">A set of exposed mutable globals.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.GlobalsSnapshot.html" title="sc_executor_common::runtime_blob::GlobalsSnapshot struct">GlobalsSnapshot</a></div><div class="item-right docblock-short">A snapshot of a global variables values. This snapshot can be later used for restoring the
values to the preserved state.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RuntimeBlob.html" title="sc_executor_common::runtime_blob::RuntimeBlob struct">RuntimeBlob</a></div><div class="item-right docblock-short">A bunch of information collected from a WebAssembly module.</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.InstanceGlobals.html" title="sc_executor_common::runtime_blob::InstanceGlobals trait">InstanceGlobals</a></div><div class="item-right docblock-short">An adapter for a wasm module instance that is focused on getting and setting globals.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="sc_executor_common" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.1 (90743e729 2023-01-10)" ></div></body></html>