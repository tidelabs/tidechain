<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="tracing-serde"><meta name="keywords" content="rust, rustlang, rust-lang, tracing_serde"><title>tracing_serde - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-6827029ac823cab7.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../static.files/light-ebce58d0a40c3431.css"><link rel="stylesheet" disabled href="../static.files/dark-f23faae4a2daf9a6.css"><link rel="stylesheet" disabled href="../static.files/ayu-8af5e100b21cd173.css"><script id="default-settings" ></script><script src="../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-c55e1eb52e1886b4.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../tracing_serde/index.html"><div class="logo-container"><img src="https://raw.githubusercontent.com/tokio-rs/tracing/master/assets/logo-type.png" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../tracing_serde/index.html"><div class="logo-container">
                    <img src="https://raw.githubusercontent.com/tokio-rs/tracing/master/assets/logo-type.png" alt="logo"></div></a><h2 class="location"><a href="#">Crate tracing_serde</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.3</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Crate <a class="mod" href="#">tracing_serde</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/tracing_serde/lib.rs.html#1-582">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="tracing-serde"><a href="#tracing-serde">tracing-serde</a></h2>
<p>An adapter for serializing <a href="https://crates.io/crates/tracing"><code>tracing</code></a> types using <a href="https://crates.io/crates/serde"><code>serde</code></a>.</p>
<p><a href="https://docs.rs/tracing-serde"><img src="https://docs.rs/tracing-serde/badge.svg" alt="Documentation" /></a>
<a href="https://tracing-rs.netlify.com/tracing_serde"><img src="https://img.shields.io/badge/docs-master-blue" alt="Documentation (master)" /></a></p>
<h3 id="overview"><a href="#overview">Overview</a></h3>
<p><a href="https://crates.io/crates/tracing"><code>tracing</code></a> is a framework for instrumenting Rust programs to collect
scoped, structured, and async-aware diagnostics.<code>tracing-serde</code> enables
serializing <code>tracing</code> types using <a href="https://crates.io/crates/serde"><code>serde</code></a>.</p>
<p>Traditional logging is based on human-readable text messages.
<code>tracing</code> gives us machine-readable structured diagnostic
information. This lets us interact with diagnostic data
programmatically. With <code>tracing-serde</code>, you can implement a
<code>Subscriber</code> to serialize your <code>tracing</code> types and make use of the
existing ecosystem of <code>serde</code> serializers to talk with distributed
tracing systems.</p>
<p>Serializing diagnostic information allows us to do more with our logged
values. For instance, when working with logging data in JSON gives us
pretty-print when we’re debugging in development and you can emit JSON
and tracing data to monitor your services in production.</p>
<p>The <code>tracing</code> crate provides the APIs necessary for instrumenting
libraries and applications to emit trace data.</p>
<p><em>Compiler support: <a href="#supported-rust-versions">requires <code>rustc</code> 1.42+</a></em></p>
<h3 id="usage"><a href="#usage">Usage</a></h3>
<p>First, add this to your <code>Cargo.toml</code>:</p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies]
tracing = &quot;0.1&quot;
tracing-serde = &quot;0.1&quot;
</code></pre></div>
<p>Next, add this to your crate:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>tracing_serde::AsSerde;</code></pre></div>
<p>Please read the <a href="https://docs.rs/tracing/latest/tracing/index.html"><code>tracing</code> documentation</a>
for more information on how to create trace data.</p>
<p>This crate provides the <code>as_serde</code> function, via the <code>AsSerde</code> trait,
which enables serializing the <code>Attributes</code>, <code>Event</code>, <code>Id</code>, <code>Metadata</code>,
and <code>Record</code> <code>tracing</code> values.</p>
<p>For the full example, please see the <a href="../examples">examples</a> folder.</p>
<p>Implement a <code>Subscriber</code> to format the serialization of <code>tracing</code>
types how you’d like.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>tracing_serde::AsSerde;
<span class="kw">use </span>serde_json::json;

<span class="kw">pub struct </span>JsonSubscriber {
    next_id: AtomicUsize, <span class="comment">// you need to assign span IDs, so you need a counter
</span>}

<span class="kw">impl </span>Subscriber <span class="kw">for </span>JsonSubscriber {

    <span class="kw">fn </span>new_span(<span class="kw-2">&amp;</span><span class="self">self</span>, attrs: <span class="kw-2">&amp;</span>Attributes&lt;<span class="lifetime">&#39;_</span>&gt;) -&gt; Id {
        <span class="kw">let </span>id = <span class="self">self</span>.next_id.fetch_add(<span class="number">1</span>, Ordering::Relaxed);
        <span class="kw">let </span>id = Id::from_u64(id <span class="kw">as </span>u64);
        <span class="kw">let </span>json = <span class="macro">json!</span>({
        <span class="string">&quot;new_span&quot;</span>: {
            <span class="string">&quot;attributes&quot;</span>: attrs.as_serde(),
            <span class="string">&quot;id&quot;</span>: id.as_serde(),
        }});
        <span class="macro">println!</span>(<span class="string">&quot;{}&quot;</span>, json);
        id
    }

    <span class="kw">fn </span>event(<span class="kw-2">&amp;</span><span class="self">self</span>, event: <span class="kw-2">&amp;</span>Event&lt;<span class="lifetime">&#39;_</span>&gt;) {
        <span class="kw">let </span>json = <span class="macro">json!</span>({
           <span class="string">&quot;event&quot;</span>: event.as_serde(),
        });
        <span class="macro">println!</span>(<span class="string">&quot;{}&quot;</span>, json);
    }

    <span class="comment">// ...
</span>}</code></pre></div>
<p>After you implement your <code>Subscriber</code>, you can use your <code>tracing</code>
subscriber (<code>JsonSubscriber</code> in the above example) to record serialized
trace data.</p>
<h4 id="unstable-features"><a href="#unstable-features">Unstable Features</a></h4>
<p>These feature flags enable <strong>unstable</strong> features. The public API may break in 0.1.x
releases. To enable these features, the <code>--cfg tracing_unstable</code> must be passed to
<code>rustc</code> when compiling.</p>
<p>The following unstable feature flags are currently available:</p>
<ul>
<li><code>valuable</code>: Enables [<code>Visit::record_value</code>] implementations, for
serializing values recorded using the <a href="https://crates.io/crates/valuable"><code>valuable</code></a> crate.</li>
</ul>
<h5 id="enabling-unstable-features"><a href="#enabling-unstable-features">Enabling Unstable Features</a></h5>
<p>The easiest way to set the <code>tracing_unstable</code> cfg is to use the <code>RUSTFLAGS</code>
env variable when running <code>cargo</code> commands:</p>
<div class="example-wrap"><pre class="language-shell"><code>RUSTFLAGS=&quot;--cfg tracing_unstable&quot; cargo build
</code></pre></div>
<p>Alternatively, the following can be added to the <code>.cargo/config</code> file in a
project to automatically enable the cfg flag for that project:</p>
<div class="example-wrap"><pre class="language-toml"><code>[build]
rustflags = [&quot;--cfg&quot;, &quot;tracing_unstable&quot;]
</code></pre></div><h3 id="supported-rust-versions"><a href="#supported-rust-versions">Supported Rust Versions</a></h3>
<p>Tracing is built against the latest stable release. The minimum supported
version is 1.42. The current Tracing version is not guaranteed to build on
Rust versions earlier than the minimum supported version.</p>
<p>Tracing follows the same compiler support policies as the rest of the Tokio
project. The current stable Rust compiler and the three most recent minor
versions before it will always be supported. For example, if the current
stable compiler version is 1.45, the minimum supported version will not be
increased past 1.42, three minor versions prior. Increasing the minimum
supported compiler version is not considered a semver breaking change as
long as doing so complies with this policy.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="fields/index.html" title="tracing_serde::fields mod">fields</a></div><div class="item-right docblock-short">Support for serializing fields as <code>serde</code> structs or maps.</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerdeMapVisitor.html" title="tracing_serde::SerdeMapVisitor struct">SerdeMapVisitor</a></div><div class="item-right docblock-short">Implements <code>tracing_core::field::Visit</code> for some <code>serde::ser::SerializeMap</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerdeStructVisitor.html" title="tracing_serde::SerdeStructVisitor struct">SerdeStructVisitor</a></div><div class="item-right docblock-short">Implements <code>tracing_core::field::Visit</code> for some <code>serde::ser::SerializeStruct</code>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerializeAttributes.html" title="tracing_serde::SerializeAttributes struct">SerializeAttributes</a></div><div class="item-right docblock-short">Implements <code>serde::Serialize</code> to write <code>Attributes</code> data to a serializer.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerializeEvent.html" title="tracing_serde::SerializeEvent struct">SerializeEvent</a></div><div class="item-right docblock-short">Implements <code>serde::Serialize</code> to write <code>Event</code> data to a serializer.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerializeField.html" title="tracing_serde::SerializeField struct">SerializeField</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerializeFieldSet.html" title="tracing_serde::SerializeFieldSet struct">SerializeFieldSet</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerializeId.html" title="tracing_serde::SerializeId struct">SerializeId</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerializeLevel.html" title="tracing_serde::SerializeLevel struct">SerializeLevel</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerializeMetadata.html" title="tracing_serde::SerializeMetadata struct">SerializeMetadata</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SerializeRecord.html" title="tracing_serde::SerializeRecord struct">SerializeRecord</a></div><div class="item-right docblock-short">Implements <code>serde::Serialize</code> to write <code>Record</code> data to a serializer.</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.AsSerde.html" title="tracing_serde::AsSerde trait">AsSerde</a></div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="tracing_serde" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.1 (d5a82bbd2 2023-02-07)" data-search-js="search-444266647c4dba98.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>